<!DOCTYPE html>
<html>
	<head>
	  <meta charset="UTF-8">
	  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	  <title>Asignaciones</title>
	  <link rel="stylesheet" href="./static/css/bootstrap.min.css">
	  <style type="text/css">
	            .tripAsigment-column {
	                vertical-align: top;
	                height: 200px;
	            }
	            .item-title {
	                float: left;
	            }
	            .kanban-column{
	              padding-left: 5px;
	              padding-right: 5px;
	            }
	            .column-items{
	              padding-bottom: 25px;
	            }
	        </style> 
	</head>
	<body>
	  	<div class="row">
	    	<div class="col-md-12" id="tripRequest-board-here">
	        
	    	</div>
	  	</div>

	  	<div class="container" id="new-trip-here">

	  	</div>

	  	<!-- template TripBoard -->
	  	<script type="text/template" id="tripRequest-template">
		    <div class="panel panel-default">
		      	<div class="panel-heading">
			      	<div class="pull-left" >
			            <h3 class="panel-title">Asignador de Rutas</h3>
			            <p>Puedes arrastrar y soltar cada cliente hacia el chofer que relalizará la ruta.<br>
			               Con el botón <spam class="glyphicon glyphicon-plus"/> de la parte superior derecha puedes agregar más choferes. 
			            </p>
			        </div>
			        <div class="pull-right">
			            <button type="button" class="btn btn-sm btn-default" data-dismiss="panel" aria-hidden="true" id="button-add-trip" title="Add Trip Asigment Column" data-toggle="modal" data-target="#myModal">
			                <span class="glyphicon glyphicon-plus"></span>
			            </button>
			        </div>                        
			    	<div class="clearfix"></div>
			    </div>
		    </div>
		    <div class="panel-body">
		        <table id="tripAssigmentBoardContainerTable" style="width: 100%" >
		            <tbody>
		              	<tr id="tripAssigment-row">
		                	<td id="passenger" class="tripAssigment-column" style="width: 35%">
		                  		<div class="panel panel-default">
			                    	<div class="panel-heading">
		                      			<div class="pull-left" id="column-passengers-title">
		                          		Solicitudes
		                      			</div>
			                      		<div class="pull-right">
			                        		<div class="btn-group btn-group-xs">
			                          			<button type="button" class="btn btn-sm btn-default" data-dismiss="panel" aria-hidden="true" id="button-add-tripAsigment-item" title="Add Trip Asigment Item">
			                            			<span class="glyphicon glyphicon-filter"></span>          
			                        		</div>
			                        	</div>
		                      			<div class="clearfix"></div>
		                      		</div>
		                      		<div  class="panel-body">
					                    <div class="column-items" id="column-items"  ondrop="drop(event)" ondragover="allowDrop(event)" dropable="true">
					                        <% _.each(tripRequests, function(tripRequest){ %>
						                        <div id="drag-clientRequest-AQUI" id_solicitud="AQUI" id_cliente="AQUI" class="panel panel-primary" draggable="true" ondragstart="drag(event)" >
						                            <div class="panel-heading">
						                        		<div class="pull-left" id="solicitud-AQUI-title">
						                                	Pasajero: <%= tripRequest.get('user').first_name %> <%= tripRequest.get('user').last_name %>
						                              	</div>
						                              	<div class="pull-right">
						                                	<div class="btn-group btn-group-xs">
						                                  		<button type="button" class="btn btn-primary btn-xs btn-default" id="button-edit-tripAsigment-item" title="Edit Column">
						                                    		<span class="glyphicon glyphicon-pencil"></span>
						                                  		</button>                        
						                                  		<button type="button" class="btn btn-primary btn-xs btn-default" id="button-delete-kanban-item" title="Trash Column">
						                                    		<span class="glyphicon glyphicon-trash"></span>
						                                  		</button>     
						                                  	</div>                                           
						                                </div>
						                                <div class="clearfix"></div> 
						                            </div>
							                        <div class="panel-body">
							                        	<div class="origen">
							                            	<b>Origen: </b><%= tripRequest.get('place_origin').name %>
							                            </div>
							                            <br/>
							                            <div class="destino">
							                            	<b>Destino: </b><%= tripRequest.get('place_destination').name %>
							                          	</div>
							                        </div>
							                    </div>
						                    <% }); %>
						                </div>
						            </div>
						        </div>    
						    </td>
						    <td id="trips" class="kanban-column">
						    	<div class="col-md-12">
						    		<% _.each(trips, function(trip){ %>
						    			<div class="col-md-6" id="trip-<%= trip.get('id')%>">						    	
						                    <div class="panel panel-default">
						                      	<div class="panel-heading">
						                      		<div class="pull-left" id="column-driver-trip-<%= trip.get('id') %>-title">
						                            	Chofer: <%= trip.get('driver').user.first_name %> <%= trip.get('driver').user.last_name %> - <%= trip.get('vehicle').plate %>
					                        		</div>
					                        		<div class="pull-right">
						                          		<div class="btn-group btn-group-xs">
							                            	<button type="button" class="btn btn-sm btn-default" id="button-trip-trash" trip_id="<%= trip.get('id') %>" title="Trash Column">
							                              		<span class="glyphicon glyphicon-trash"></span>
							                            	</button>            
						                          		</div>
						                        	</div>
						                        	<div class="clearfix"></div>
						                    	</div>
							                    <div id="div-assigment-trip-<%= trip.get('id') %>" class="panel-body">
					                        		<div class="column-items" name="trip" id_trip="trip-<%= trip.get('id') %>" id="column-items-<%= trip.get('id') %>" ondrop="drop(event)" ondragover="allowDrop(event)" dropable="true">
					                        			<% _.each(trip.get('passengers'), function(passenger){ %>
					                        				<div id="drag-clientPreAsigment-<%= passenger.id %>" class="panel panel-primary" draggable="true" ondragstart="drag(event)">
					                            				<div class="panel-heading">
					                              					<div class="pull-left" id="column-<%= passenger.id %>-title">
					                                					Pasajero: <%= passenger.first_name %> <%= passenger.last_name %>
					                              					</div>
					                              					<div class="pull-right">
					                                					<div class="btn-group btn-group-xs">                      
					                                  						<button type="button" class="btn btn-primary btn-xs btn-default" id="button-delete-kanban-item" title="Trash Column">
					                                    						<span class="glyphicon glyphicon-trash"></span>
					                                  						</button>                                                
					                                					</div>
					                              					</div>
					                              					<div class="clearfix"></div>
					                              				</div>                    
									                            <div class="panel-body">
									                              Origen: ...
									                            </div>
									                        </div>
									                    <% }); %>
							                        </div>
							                    </div>  
						                    </div> 
					            		</div>
					        		<% }); %>
					        	</div>
					        </td>
					    </tr>
		            </tbody>
		        </table>
		    </div>
		    <!-- Modal -->
		  	<div class="modal fade" id="myModal" role="dialog">
			    <div class="modal-dialog">
			    <!-- Modal content-->
			      	<div class="modal-content">
			      		<form id="newTrip-form">
			    	    	<div class="modal-header">
			        	  		<button type="button" class="close" data-dismiss="modal">&times;</button>
			          			<h4 class="modal-title">Nueva ruta</h4>
			        		</div>
			        		<div class="modal-body">
		        				<label>Chofer: </label>
		        				<select id="newTripDriver" name="driver">
		        					<% _.each(drivers, function(driver){ %>
									  <option value="<%= driver.get('user').id %>"><%= driver.get('user').first_name %> <%= driver.get('user').last_name %></option>
								  	<% }); %>
								</select>
		        				<label>Vehículo: </label>
		        				<select id="newTripVehicle" name="vehicle">
		        					<% _.each(vehicles, function(vehicle){ %>
									  <option value="<%= vehicle.get('id') %>"><%= vehicle.get('plate') %> </option>
								  	<% }); %>
								</select>
			        		</div>
			        		<div class="modal-footer">
			        			<button type="submit" class="btn btn-default" data-dismiss="modal" id="createNnewTrip" from="newTrip-form">Crear</button>			          			<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
			        		</div>
		        		</form>
		      		</div>
		    	</div>
		  	</div>
		</script>
		<br/>

		<!-- Libraries -->
		<script src="./static/js/jquery-3.2.1.min.js" type="text/javascript"></script>
	  	<script src="./static/js/underscore-min.js" type="text/javascript"></script>
	  	<script src="./static/js/backbone-min.js" type="text/javascript"></script>
	  	<script src="./static/js/assigment.js" type="text/javascript"></script>
	  	<script src="./static/js/bootstrap.min.js" type="text/javascript"></script>
	</body>
</html>


